<template>
    <div
        :class="$style.LogoIda"
    >
        <svg
            :class="$style.logo"
            fill="currentColor"
            viewBox="0 0 54 27"
            xmlns="http://www.w3.org/2000/svg"
        >
            <g>
                <path
                    d="M0 1.51743C0 0.638917 0.6968 0 1.58715 0C2.51622 0 3.17431 0.638917 3.17431 1.51743C3.17431 2.43588 2.51622 3.07479 1.58715 3.07479C0.6968 3.07479 0 2.43588 0 1.51743Z"
                />
                <path
                    d="M0.269531 12.6412H2.86317V3.8561H0.269531V12.6412ZM10.3344 0.421875V4.8943C9.79243 4.17552 8.97953 3.69633 7.9343 3.69633C5.84393 3.69633 4.14064 5.53323 4.14064 8.24863C4.14064 10.9241 5.80519 12.8009 7.9343 12.8009C9.01823 12.8009 9.79243 12.3217 10.3344 11.6429V12.5613H12.928V0.421875H10.3344ZM8.5537 10.2452C7.54722 10.2452 6.77297 9.48653 6.77297 8.24863C6.77297 7.05067 7.54722 6.25202 8.5537 6.25202C9.56019 6.25202 10.3344 7.05067 10.3344 8.24863C10.3344 9.48653 9.56019 10.2452 8.5537 10.2452ZM19.896 3.89599V4.8943C19.3541 4.17552 18.5411 3.69633 17.4959 3.69633C15.4055 3.69633 13.7022 5.53323 13.7022 8.24863C13.7022 10.9241 15.3668 12.8009 17.4959 12.8009C18.5798 12.8009 19.3541 12.3217 19.896 11.6429V12.5613H22.4897V3.85606H19.896V3.89599ZM18.1153 10.2452C17.1088 10.2452 16.3346 9.48653 16.3346 8.24863C16.3346 7.05067 17.1088 6.25202 18.1153 6.25202C19.1218 6.25202 19.896 7.05067 19.896 8.24863C19.896 9.48653 19.1218 10.2452 18.1153 10.2452Z"
                />
                <path
                    d="M5.30196 13.9054C4.21803 13.9054 3.44383 14.3846 2.90188 15.1034V14.105H0.269531V26.7636H2.86317V21.8918C3.40512 22.5707 4.17933 23.0499 5.26326 23.0499C7.43107 23.0499 9.05692 21.1731 9.05692 18.4976C9.09562 15.7822 7.43107 13.9054 5.30196 13.9054ZM4.6826 20.4543C3.6761 20.4543 2.90188 19.6955 2.90188 18.4577C2.90188 17.2597 3.6761 16.461 4.6826 16.461C5.68908 16.461 6.46329 17.2597 6.46329 18.4577C6.46329 19.6955 5.68908 20.4543 4.6826 20.4543ZM14.941 13.9054C13.8571 13.9054 13.0055 14.3846 12.5022 15.4627V14.105H9.90857V22.8103H12.5022V19.0567C12.5022 17.06 13.7022 16.7007 14.9023 16.7007C15.1345 16.7007 15.2507 16.7007 15.4055 16.7406V13.9852C15.2894 13.9453 15.1345 13.9054 14.941 13.9054ZM20.0121 13.9054C17.5733 13.9054 15.5991 15.8221 15.5991 18.4577C15.5991 21.0533 17.5346 23.01 20.0121 23.01C22.4896 23.01 24.4252 21.0932 24.4252 18.4577C24.4252 15.8221 22.4509 13.9054 20.0121 13.9054ZM20.0121 16.461C21.0186 16.461 21.7929 17.2597 21.7929 18.4577C21.7929 19.6955 21.0186 20.4543 20.0121 20.4543C19.0056 20.4543 18.2314 19.6955 18.2314 18.4577C18.2314 17.2597 18.9669 16.461 20.0121 16.461ZM25.1994 26.8035H27.793V14.105H25.1994V26.8035ZM33.0191 13.9054C30.3867 13.9054 28.5673 15.902 28.5673 18.4577C28.5673 21.0133 30.3867 23.01 33.0965 23.01C34.9159 23.01 36.6966 22.0915 37.2772 19.9352H34.6062C34.4126 20.5741 33.832 20.9335 33.1352 20.9335C32.2448 20.9335 31.3932 20.3744 31.2771 19.0167H37.4321C37.6644 16.1815 35.8062 13.9054 33.0191 13.9054ZM33.0191 15.9819C33.9481 15.9819 34.4901 16.5808 34.6836 17.4194H31.3158C31.5093 16.5808 32.09 15.9819 33.0191 15.9819ZM42.3097 23.0499C44.3613 23.0499 46.2971 21.812 46.5679 19.3761H43.8969C43.7034 20.2147 43.0064 20.5342 42.3097 20.5342C41.2256 20.5342 40.529 19.6955 40.529 18.4577C40.529 17.2198 41.1871 16.3812 42.3097 16.3812C43.0064 16.3812 43.6646 16.7007 43.8581 17.5392H46.529C46.2582 15.2231 44.3613 13.9054 42.2708 13.9054C39.6773 13.9054 37.8192 15.902 37.8192 18.4577C37.8192 21.0133 39.716 23.0499 42.3097 23.0499ZM53.5744 20.0949C52.8393 20.3345 52.2972 20.5342 51.8325 20.5342C51.1747 20.5342 50.7488 20.1348 50.7488 19.2962V16.6607H53.5744V14.145H50.7488V11.749L48.1552 12.348V14.145H46.7225V16.6607H48.1552V19.456C48.1552 22.0516 49.742 23.0499 51.3682 23.0499C52.4134 23.0499 53.5359 22.6506 54.0003 22.2912L53.5744 20.0949Z"
                    fill="url(#ida-gradient)"
                />
                <path
                    ref="coma"
                    :class="[$style.coma, {[$style._isFiled]: isWordFilled}]"
                    d="M24.8906 11.5087C24.8906 10.6301 25.5874 9.99121 26.4778 9.99121C27.4069 9.99121 28.0649 10.6301 28.0649 11.5087C28.0649 12.4271 27.4069 13.066 26.4778 13.066C25.5874 13.066 24.8906 12.4271 24.8906 11.5087Z"
                />
            </g>

            <defs>
                <linearGradient
                    id="ida-gradient"
                    x1="0"
                    x2="0"
                    y1="1"
                >
                    <stop
                        :class="$style.stopFill"
                        :offset="`${offset}%`"
                    />

                    <stop
                        :class="$style.stop"
                        offset="0%"
                    />
                </linearGradient>
            </defs>
        </svg>
    </div>
</template>

<script>
export default {
    name: 'LogoIda',

    props: {
        isHover: Boolean,
        isBlur: Boolean,
        duration: {
            type: Number,
            default: .3,
        },
    },

    data() {
        return {
            isHovered: false,
            isWordFilled: false,
            offset: 0,
            timer: null,
            comaPosition: 'translate3d(0, -10px, 0)',
        };
    },

    computed: {
        comaTransition() {
            return `transform ${this.duration / 2}s`;
        },
    },

    watch: {
        isHover(val) {
            this.handleHover(val);
        },

        offset(val) {
            this.isWordFilled = false;

            if (val === 0) {
                clearInterval(this.timer);
                return;
            }
            if (val === 76) {
                this.animateComa();
                return;
            }
            if (val === 100) {
                clearInterval(this.timer);
                this.isWordFilled = true;
                this.animateComa();
            }
        },
    },

    beforeDestroy() {
        if (this.timer) {
            clearInterval(this.timer);
            this.timer = null;
        }
    },

    methods: {
        handleHover(val) {
            this.isHovered = val;

            if (val) {
                clearInterval(this.timer);
                this.timer = setInterval(() => {
                    this.offset += 1;
                }, this.duration * 10);
            }

            if (!val) {
                clearInterval(this.timer);
                this.timer = setInterval(() => {
                    this.offset -= 1;
                }, this.duration * 10);
            }
        },

        animateComa() {
            const coma = this.$refs.coma;
            if (!coma) {
                return;
            }

            coma.style.transition = this.comaTransition;

            if (this.isWordFilled || !this.isHovered) {
                coma.style.transform = '';
                return;
            }
            if (this.isHovered) {
                coma.style.transform = this.comaPosition;
            }
        },
    },
};
</script>

<style lang="scss" module>
    $fill-logo-color: $lime;

    .LogoIda {
        position: relative;
        cursor: pointer;

        .logo {
            position: relative;
            width: 5.8rem;
            height: 2.8rem;
            transform: translate3d(0, 0, 0);
            transition: opacity $default-transition;
        }

        .coma {
            &._isFiled {
                fill: $fill-logo-color;
            }
        }

        .stop {
            stop-color: currentcolor;
        }

        .stopFill {
            stop-color: $fill-logo-color;
        }
    }
</style>
